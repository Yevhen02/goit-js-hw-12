{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst API_BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '42034785-c436f003c310c5b5229f24b7b';\n\naxios.defaults.baseURL = API_BASE_URL;\n\nlet limit;\n\nconst searchParams = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  per_page: 20,\n  page: 1,\n};\n\nconst simpleGallery = new SimpleLightbox('.gallery a', {\n  overlayOpacity: 0.7,\n  captionsData: 'alt',\n  captionDelay: 500,\n  captionPosition: 'center',\n});\n\nconst formElem = document.querySelector('.gallery-form');\nconst searchInputElem = document.querySelector('.search-input');\nconst galleryElem = document.querySelector('.gallery');\nconst loaderElem = document.querySelector('.loader');\nconst loadMoreBtnElem = document.querySelector('.load-more-btn');\n\nasync function startSearch(event) {\n  event.preventDefault();\n  if (!searchInputElem.value.trim()) {\n    showErrorMessage('Please fill in the search field');\n    return;\n  }\n  try {\n    galleryElem.innerHTML = '';\n    isContentVisible(loaderElem, true);\n    isContentVisible(loadMoreBtnElem, false);\n    searchParams.q = searchInputElem.value.trim();\n    searchParams.page = 1;\n    const data = await fetchPhotos();\n    limit = data.totalHits;\n    createGallery(data);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function loadMore() {\n  try {\n    isContentVisible(loaderElem, true);\n    isContentVisible(loadMoreBtnElem, false);\n    const photos = await fetchPhotos();\n    createGallery(photos);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function fetchPhotos() {\n  const response = await axios.get('', { params: searchParams });\n  return response.data;\n}\n\nfunction createGallery(photos) {\n  if (!photos.total) {\n    showErrorMessage(\n      'Sorry, there are no images matching your search query. Please, try again!'\n    );\n    isContentVisible(loaderElem, false);\n    return;\n  }\n  const markup = photos.hits\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n          <a href=\"${largeImageURL}\">\n            <img class=\"api-img\" src=\"${webformatURL}\" alt=\"${tags}\">\n            <div class=\"img-desc\">\n            <p class=\"para\">Likes: <span class=\"span\"> <br/>${likes}</span></p>\n            <p class=\"para\">Views: <span class=\"span\"> <br/>${views}</span></p>\n            <p class=\"para\">Comments: <span class=\"span\"> <br/>${comments}</span></p>\n            <p class=\"para\">Downloads: <span class=\"span\"> <br/>${downloads}</span></p>\n            </div>\n          </a>\n        </li>`;\n      }\n    )\n    .join('');\n\n  galleryElem.insertAdjacentHTML('beforeend', markup);\n  isContentVisible(loaderElem, false);\n  checkLimit();\n  scrollPage();\n  simpleGallery.refresh();\n  formElem.reset();\n}\n\nfunction checkLimit() {\n  if (Math.ceil(limit / searchParams.per_page) === searchParams.page) {\n    showErrorMessage(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n  } else {\n    searchParams.page += 1;\n    isContentVisible(loadMoreBtnElem, true);\n  }\n}\n\nfunction isContentVisible(content, isVisible) {\n  if (isVisible) {\n    content.classList.remove('hidden');\n  } else {\n    content.classList.add('hidden');\n  }\n}\n\nfunction scrollPage() {\n  if (searchParams.page > 1) {\n    const rect = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect();\n    window.scrollBy({ top: rect.height * 2, left: 0, behavior: 'smooth' });\n  }\n}\n\nfunction showErrorMessage(message) {\n  iziToast.show({\n    position: 'bottomCenter',\n    title: 'X',\n    titleColor: '#FFF5E0',\n    titleSize: '20px',\n    message,\n    backgroundColor: '#FF6969',\n    messageColor: '#FFF5E0',\n    messageSize: '14px',\n    close: false,\n    closeOnClick: true,\n    closeOnEscape: true,\n  });\n}\n\nformElem.addEventListener('submit', event => startSearch(event));\n\nloadMoreBtnElem.addEventListener('click', () => loadMore());\n"],"names":["API_BASE_URL","API_KEY","axios","limit","searchParams","simpleGallery","SimpleLightbox","formElem","searchInputElem","galleryElem","loaderElem","loadMoreBtnElem","startSearch","event","showErrorMessage","isContentVisible","data","fetchPhotos","createGallery","error","loadMore","photos","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","checkLimit","scrollPage","content","isVisible","rect","message","iziToast"],"mappings":"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"}